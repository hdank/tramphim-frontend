---
export const prerender = false;
export const revalidate = 1800; 
import BaseLayout from "../layouts/Layout.astro";
import { getHomePageData } from "../utils/getMovieHome.js";
import Hero from "../components/Hero/Hero";
import Header from "../components/Header/Header";
import Footer from "../components/Footer/index";
import MovieCardColumn from "../components/MovieCardHome/CardColumn.jsx";
import MovieCardTop from "../components/MovieCardHome/CardColumnTop.jsx";
import MovieCardCategory from "../components/MovieCardHome/CardPhimCategory.jsx";
import SeoHome from "../seometas/SeoHome.astro";
import ChuDe from "../components/ToPics/ToPics.jsx";
const homePageData = await getHomePageData();
const {
  movieheros,
  moviehots,
  movieupdates,
  themes,
  moviechieuraps,
  moviephimbos,
  moviephimles,
} = homePageData;
const loading = false;
const error = null;
---

<BaseLayout>
  <Fragment slot="head">
    <SeoHome />
  </Fragment>

  <div id="splash-screen"></div>
  <Header client:load />

  <div class="main-container">
    <h1 class="sr-only">
      Motchill - Phim Mới, Phim Hay Vietsub | Xem Online Full HD 4K
    </h1>

    <div class="main-content-wrapper">
      <main id="main-content">
        <Hero client:load movies={moviehots} loading={loading} />
        <ChuDe client:idle themesData={themes} />
        <div class="card-column-gap">
          <section>
            <MovieCardTop
              client:idle
              movies={moviehots}
              title="TOP 10 Hôm Nay"
              loading={loading}
              error={error}
            />
          </section>
          <section>
            <MovieCardColumn
              client:idle
              title="Phim Có Tập Mới"
              movies={movieupdates}
              loading={loading}
              error={error}
            />
          </section>
          <section class="fade-in-on-visible">
            <MovieCardColumn
              client:idle
              title="Phim Chiếu Rạp Hot Nhất 2025"
              movies={moviechieuraps}
              loading={loading}
              error={error}
            />
          </section>
          <section class="fade-in-on-visible">
            <MovieCardColumn
              client:visible
              title="Phim Lẻ"
              movies={moviephimles}
              loading={loading}
              error={error}
            />
          </section>
          <section class="fade-in-on-visible">
            <MovieCardColumn
              client:visible
              title="Phim Bộ"
              movies={moviephimbos}
              loading={loading}
              error={error}
            />
          </section>
          <!-- <section class="fade-in-on-visible">
            <MovieCardCategory
              client:visible
              title="Phim Lẻ "
              category="phim-le"
            />
          </section>
          <section class="fade-in-on-visible">
            <MovieCardCategory
              client:visible
              title="Phim Bộ"
              category="phim-bo"
            />
          </section> -->
        </div>
      </main>
    </div>
  </div>
  <footer>
    <Footer />
  </footer>
</BaseLayout>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const sections = document.querySelectorAll(".fade-in-on-visible");

    const observerOptions = {
      root: null,
      rootMargin: "0px",
      threshold: 0.2,
    };

    const observer = new IntersectionObserver((entries, observer) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("is-visible");
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    sections.forEach((section) => {
      observer.observe(section);
    });
  });
</script>
