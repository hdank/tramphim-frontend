import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as t}from"./index.Be8AcK8B.js";import{u as c}from"./AuthProvider.DtbN1DVM.js";function u({levelId:r,onClose:a}){const{user:s,refreshUser:o}=c(),[l,n]=t.useState("");return t.useEffect((()=>{if(s&&r){const e=`http://localhost:3000?email=${encodeURIComponent(s.email)}&level_id=${r}`;n(e)}}),[s,r]),t.useEffect((()=>{const e=async e=>{"GAME_COMPLETE"===e.data.type&&console.log("[MemoryCardGameIframe] Game Complete! Score:",e.data.score),"POINTS_UPDATED"===e.data.type&&(console.log("[MemoryCardGameIframe] Points Updated! New Points:",e.data.points),console.log("[MemoryCardGameIframe] Calling refreshUser()..."),await o(),console.log("[MemoryCardGameIframe] refreshUser() completed")),"NAVIGATE_BACK"===e.data.type&&(console.log("[MemoryCardGameIframe] Received NAVIGATE_BACK - closing game"),a())};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)}),[o,a]),s?l?e.jsx("div",{className:"relative w-full h-full bg-gray-900 rounded-xl overflow-hidden shadow-2xl border border-gray-700",children:e.jsx("iframe",{src:l,title:"Memory Card Game",className:"w-full h-full border-0",allow:"fullscreen"})}):e.jsx("div",{className:"h-screen bg-gray-900"}):e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900 text-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Vui lòng đăng nhập"}),e.jsx("a",{href:"/dang-nhap",className:"text-sky-400 hover:underline",children:"Đăng nhập ngay"})]})})}export{u as default};