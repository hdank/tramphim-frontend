import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.Be8AcK8B.js";import{g as m}from"./WatchedMoviesDropdown.CJi1npJU.js";function f(){const[o,c]=n.useState([]),[d,x]=n.useState(!0);return n.useEffect(()=>{(async()=>{try{const a=await m(),r=new Map;a.forEach(t=>{if(t.progress/t.duration*100<90){const l=t.slug;(!r.has(l)||new Date(t.lastUpdated)>new Date(r.get(l).lastUpdated))&&r.set(l,t)}});const h=Array.from(r.values()).sort((t,i)=>new Date(i.lastUpdated)-new Date(t.lastUpdated));c(h)}catch(a){console.error("Error loading history:",a)}finally{x(!1)}})()},[]),d?e.jsx("div",{className:"p-10 text-center text-white",children:"Đang tải..."}):e.jsx("div",{className:"min-h-screen bg-[#191B24] px-4 py-8 md:px-8",children:e.jsxs("div",{className:"mx-auto max-w-7xl",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-2xl font-bold text-white md:text-3xl",children:"Lịch Sử Xem"})}),o.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:o.map(s=>{const a=s.progress/s.duration*100,r=s.ngonngu||"vi";return e.jsxs("a",{href:`/xem-phim/${s.slug}/tap-${s.sotap}/${r}`,className:"group relative flex overflow-hidden rounded-lg bg-[#23252b] transition-colors hover:bg-[#2a2c33]",children:[e.jsxs("div",{className:"relative w-32 flex-shrink-0 overflow-hidden",children:[e.jsx("img",{src:s.banner||s.poster_url,alt:s.ten_phim,className:"h-full w-full object-cover transition-transform group-hover:scale-105"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-700",children:e.jsx("div",{className:"h-full bg-sky-500",style:{width:`${a}%`}})})]}),e.jsxs("div",{className:"flex flex-1 flex-col justify-center p-4",children:[e.jsx("h3",{className:"line-clamp-1 text-sm font-medium text-white group-hover:text-sky-400",children:s.ten_phim}),e.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Đang xem tập ",s.sotap]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:new Date(s.lastUpdated).toLocaleDateString("vi-VN")})]})]},s.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"rounded-full bg-white/5 p-6",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-10 w-10 text-gray-500",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-white",children:"Chưa có lịch sử xem"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"Các phim bạn đang xem dở sẽ hiện ở đây."}),e.jsx("a",{href:"/",className:"mt-6 rounded-md bg-sky-500 px-6 py-2 text-sm font-medium text-white hover:bg-sky-400 transition-colors",children:"Khám phá phim ngay"})]})]})})}export{f as default};
