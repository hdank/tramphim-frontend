import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.DtoOFyvK.js";function E({initialSearchMovies:o=[],searchKeyword:a="",initialData:c,baseUrl:g,initialLimit:d,tittle:P}){const s=!!a,[h,m]=i.useState(s?o:c?.data||[]),[w,b]=i.useState(s?{current_page:1,total_pages:1}:c?.pagination||{current_page:1,total_pages:1}),[l,y]=i.useState(!1),[x,N]=i.useState(null);i.useEffect(()=>{m(s?o:c?.data||[]),b(s?{current_page:1,total_pages:1}:c?.pagination||{current_page:1,total_pages:1})},[o,a,c,s]);const r=w.current_page,p=w.total_pages,k=i.useCallback(async(t=1)=>{y(!0),N(null);try{let n;s&&a?n=`${g}/api/search/?q=${encodeURIComponent(a)}&page=${t}&limit=${d}`:n=`${g}/api/phim/?page=${t}&limit=${d}&sort=luot-xem`;const f=await fetch(n);if(!f.ok)throw new Error(`Lỗi khi fetch API: ${n} - Status: ${f.status}`);const $=await f.json();m($.data||[]),b($.pagination||{current_page:1,total_pages:1});const j=new URL(window.location.pathname,window.location.origin);s&&a&&j.searchParams.set("q",encodeURIComponent(a)),j.searchParams.set("page",t.toString()),window.history.pushState(null,"",j.toString())}catch{N("Không thể tải phim. Vui lòng thử lại."),m([])}finally{y(!1)}},[g,d,s,a]),u=t=>{k(t)},_=[],v=Math.max(1,r-2),C=Math.min(p,v+4);for(let t=v;t<=C;t++)_.push(t);const S=s?`Kết Quả Với Từ Khóa: "${a}"`:P||"Tuyển Tập Phim";return e.jsxs("div",{children:[e.jsx("div",{className:"",children:e.jsx("div",{className:"flex flex-row items-center justify-between gap-8 lg:justify-start",children:e.jsx("h1",{className:"mb-4 text-lg font-semibold lg:text-xl",children:S})})}),x&&e.jsx("div",{className:"mt-8 text-center text-red-500",children:x}),l&&e.jsx("div",{className:"mt-8 text-center text-gray-400",children:"Đang tải phim..."}),!l&&!x&&h.length===0&&e.jsx("div",{className:"mt-8 text-center text-gray-400",children:"Không tìm thấy phim nào phù hợp."}),!l&&!x&&h.length>0&&e.jsx("div",{className:"mt-4 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-1",children:h.map(t=>e.jsx("a",{href:`/phim/${t.slug}`,className:"group flex flex-row gap-2 lg:gap-8",children:e.jsx("div",{children:e.jsxs("div",{className:"group flex flex-row gap-2 lg:gap-8",children:[e.jsx("div",{className:"relative h-36 w-24 overflow-hidden rounded-[4px] lg:h-56 lg:w-40",children:e.jsx("img",{src:t.poster_url,alt:t.title||t.ten_phim,className:"h-full w-full rounded-[4px] object-cover",fetchPriority:"high"})}),e.jsxs("div",{className:"flex flex-1 flex-col justify-between px-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"line-clamp-2 text-sm font-semibold text-white hover:text-sky-300 lg:text-xl",title:t.ten_phim,children:t.ten_phim}),e.jsx("p",{className:"mt-1 line-clamp-1 text-xs font-medium text-gray-400 lg:text-base",children:t.ten_khac}),e.jsxs("p",{className:"text-gray-20 mt-1 line-clamp-1 text-xs font-medium lg:text-sm",children:[e.jsx("span",{className:"text-[#a9a9ac]",children:"Năm: "}),t.nam_phat_hanh]}),e.jsxs("p",{className:"text-gray-20 mt-1 line-clamp-1 text-xs font-medium lg:text-sm",children:[e.jsx("span",{className:"text-[#a9a9ac]",children:"Tình Trạng: "}),t.tinh_trang]}),e.jsxs("p",{className:"text-gray-20 mt-1 line-clamp-1 text-xs font-medium lg:text-sm",children:[e.jsx("span",{className:"text-[#a9a9ac]",children:"Chất Lượng: "}),t.chat_luong]}),t.dien_vien&&t.dien_vien.length>0&&e.jsxs("h2",{className:"my-1 hidden text-[13px] font-medium text-[#a9a9ac] md:block lg:text-sm",children:["Diễn viên:",e.jsx("span",{className:"my-1 line-clamp-2 text-white",children:t.dien_vien.map(n=>n.ten).join(", ")})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"inline-flex items-center rounded-full bg-sky-400 px-2 py-1 text-xs font-medium text-white transition-colors duration-300 lg:px-3 lg:py-2 lg:text-sm",children:"Xem Ngay"})})]})]})})},t.id))}),p>1&&e.jsxs("nav",{className:"mt-8 flex flex-wrap items-center justify-center gap-2",children:[r>1&&e.jsx("button",{onClick:()=>u(r-1),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border border-gray-600 bg-[#23252b] text-sm text-gray-300 hover:bg-gray-600","aria-label":"Trang trước",disabled:l,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",children:e.jsx("path",{fill:"currentColor",d:"m2 10l8 8l1.4-1.4L5.8 11H18V9H5.8l5.6-5.6L10 2z"})})}),_.map(t=>e.jsx("button",{onClick:()=>u(t),className:`flex h-8 w-8 items-center justify-center rounded-[4px] border text-sm ${r===t?"border-orange-400 bg-orange-500 text-white":"border-gray-600 bg-[#23252b] text-gray-300 hover:bg-gray-600"}`,disabled:l,children:t},t)),r<p&&e.jsx("button",{onClick:()=>u(r+1),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border border-gray-600 bg-[#23252b] text-sm text-gray-300 hover:bg-gray-600","aria-label":"Trang sau",disabled:l,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",children:e.jsx("path",{fill:"currentColor",d:"M8.6 3.4L14.2 9H2v2h12.2l-5.6 5.6L10 18l8-8l-8-8z"})})})]})]})}export{E as default};
